# Макаревич Мария, БПИ 228
Индивидуальное домашнее задание 2 по дисциплине "Операционные системы". **Работа выполнена на N баллов.**
## Вариант 3
Задача о Винни-Пухе – 2 или неправильные пчелы. N пчел живет в улье. Каждая пчела может собирать мед или сторожить улей (N > 3). Пчела не покинет улей, если кроме нее в нем нет других пчел. Каждая пчела приносит за раз одну порцию меда. Всего в улей может войти тридцать порций меда. Вини-Пух спит пока меда в улье меньше половины, но как только его становится достаточно, он просыпается и пытается достать весь мед из улья. Если в улье находится меньше трех пчел, Вини-Пух забирает мед, убегает, съедает мед и снова засыпает. Если пчел три или больше, то они кусают Винни-Пуха, он убегает, лечит укус некоторое время, а затем снова бежит за медом. Создать приложение, моделирующее поведение пчел и медведя. Осуществить балансировку, обеспечивающую циклическое освобождение улья от меда. Медведя и каждую из пчел представить отдельными процессами.
## 4-5 баллов
### Сценарий решаемой задачи
В моей программе каждую пчелу, а также Винни Пуха, олицетворяет отдельный процесс-ребенок. Все они запускаются в одном файле с помощью команды fork(). Количество пчел в улье задается пользователем через командуую строку. **Тестировать программу удобнее всего при количестве пчел, равном 4.**

В программе используется объект разделяемой памяти honey_portions - количество порций меда в улье, а также два семафора: bees, отвечающий за количество пчел, которые могут покинуть улей, и hive_access, отвечающий за доступ к улью (чтобы Винни Пух и пчелы не могли одновременно проводить операции с ульем и, соответственно, honey_portions). Отметим, что из семафора bees можно также понять количество пчел, находящихся в улье, - оно равно значению семафора, увеличенному на 1, - что нужно для алгоритма кражи меда.

Пчелы на протяжении всей работы программы вылетают из улья, если у них есть такая возможность (т.е. bees != 0), через некоторое время (реализуемое вызовом команды sleep()) возвращаются в улей с медом, пополняют его запасы в улье, то есть увеличивают honey_portions, если это возможно, и на какое-то время остаются в улье, после чего процесс повторяется снова. Винни Пух наблюдает за ульем и, когда в улье накапливается достаточное количество меда (то есть honey_portions становится больше или равно 15), пытается украсть его. Далее, в зависимости от количества пчел в улье, получаемом из значения семафора bees, Винни либо опустошает улей, приравнивая honey_portions к 0, либо, покусанный пчелами, уходит лечиться, после чего процесс повторяется снова.
